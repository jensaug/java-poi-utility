{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "definitions": {
        "measurementRef": {
            "type": "object",
            "properties": {
                "name": {
                    "title": "Mätningsnamn",
                    "description": "Namnet på mätningen",
                    "type": "string"
                },
                "grouping": {
                    "title": "Mätningsgrupp",
                    "description": "Namn på grupp av mätningar som denna mätningen tillhör, kan vara tex Primärvård",
                    "type": "string"
                },
                "period": {
                    "title": "Mätningsperiod",
                    "description": "Den tidsperiod mätningen utförs",
                    "type": "string"
                }
            },
            "additionalProperties": false,
            "required": [
                "name",
                "grouping",
                "period"
            ]
        }
    },
    "properties": {
        "_id": {
            "type": "string"
        },
        "measurement": {
            "type": "object",
            "properties": {
                "/": {
                    "$ref": "#/definitions/measurementRef"
                }
            }
        },
        "previousMeasurement": {
            "type": "object",
            "properties": {
                "/": {
                    "$ref": "#/definitions/measurementRef"
                }
            }
        },
        "diarie": {
            "type": "object",
            "properties": {
                "number": {
                    "title": "Nummer",
                    "description": "Diarienummer",
                    "type": "string"
                },
                "link": {
                    "title": "Länk",
                    "description": "Länk till diarium",
                    "type": "string"
                }
            },
            "additionalProperties": false
        },
        "hsaId": {
            "type": "string"
        },
        "hassan": {
            "type": "object"
        },
        "dn": {
            "title": "Organisationsbeskrivning",
            "description": "Organisationsbeskrivning för detta mätningsunderlag",
            "type": "string"
        },
        "previousDn": {
            "title": "Tidigare organisationsbeskrivning",
            "description": "Tidigare organisationsbeskrivning för detta mätningsunderlag",
            "type": "string"
        },
        "historicDn": {
            "title": "Historisk organisationsbeskrivning",
            "description": "Historisk organisationsbeskrivning för detta mätningsunderlag",
            "type": "string"
        },
        "status": {
            "title": "Status",
            "enum": [
                "generated",
                "invited",
                "accepted",
                "done"
            ]
        },
        "created": {
            "title": "Skapad",
            "description": "När mätningsunderlaget skapades",
            "type": "string"
        },
        "alternativeIdSystem": {
            "title": "Alternativt registersystem",
            "description": "Om ett alternativt registerstytem används anges det här",
            "type": "string"
        },
        "selectionCriterias": {
            "title": "Urvalskriterier",
            "description": "De urvalskriterier som är aktuella för mätningsunderlaget",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "name": {
                        "title": "Namn",
                        "description": "Namn på urvalskriterie",
                        "type": "string"
                    },
                    "optOut": {
                        "title": "Avstå urvalskriterie",
                        "description": "Om mätningsunderlaget ska avstå detta urvalskriterie",
                        "type": "boolean"
                    },
                    "versions": {
                        "title": "Versioner",
                        "description": "Versioner av urvalskriterie",
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "name": {
                                    "title": "Namn",
                                    "type": "string"
                                },
                                "questionnaire": {
                                    "type": "object",
                                    "properties": {
                                        "name": {
                                            "anyOf": [{
                                                    "type": "string"
                                                }, {
                                                    "type": "null"
                                                }]
                                        }
                                    },
                                    "additionalProperties": false
                                }
                            },
                            "additionalProperties": false
                        }
                    }
                },
                "additionalProperties": false
            }
        },
        "specific": {
            "title": "Mätningsunderlagsspecifik information",
            "type": "object",
            "properties": {}
        },
        "organisations": {
            "title": "Ingående enheter",
            "description": "Ingående enheter i mätningsunderlaget",
            "type": "array",
            "items": {
                "type": "object",
                "properties": {
                    "dn": {
                        "title": "Organisationsbeskrivning",
                        "description": "Organisationsbeskrivning för enheten",
                        "type": "string"
                    },
                    "previousDn": {
                        "title": "Tidigare organisationsbeskrivning",
                        "description": "Organisationsbeskrivning för enheten när den förra mätnignen gjordes",
                        "type": "string"
                    },
                    "historicDn": {
                        "title": "Historisk organisationsbeskrivning",
                        "description": "Organisationsbeskrivning som beskriver den historiska kopplingen för enhten",
                        "type": "string"
                    },
                    "hsaId": {
                        "title": "HSA Id",
                        "description": "HSA Id för enheten",
                        "type": "string"
                    },
                    "hassan": {
                        "title": "HSA information",
                        "description": "HSA information genom integration till HSA registret via Hassan",
                        "type": "object",
                        "properties": {}
                    },
                    "alternativeId": {
                        "title": "Alternativt id",
                        "description": "Id för enheten i det alternativa id systemet om sådant används",
                        "type": "string"
                    },
                    "publicDn": {
                        "title": "Publik organisationsbeskrivning",
                        "description": "Organisationsbeskrivnign som ska användas när resultaten ska återföras publikt",
                        "type": "string"
                    },
                    "specific": {
                        "title": "Enhetsspecifik information",
                        "description": "Enhetsspecifik information konfigurerad i mätningen",
                        "type": "object",
                        "properties": {}
                    },
                    "invitation": {
                        "title": "Inforamtion kring inbjudan",
                        "description": "Information som är kring inbjudan så som namn",
                        "type": "object",
                        "properties": {}
                    },
                    "selections": {
                        "title": "Inbjudan",
                        "description": "Hur många enkäter som ska skickas i vilka urvalskriterier",
                        "type": "object",
                        "properties": {}
                    },
                    "metadata": {
                        "title": "Metadata",
                        "description": "Metadata kring enheten",
                        "type": "object",
                        "properties": {}
                    },
                    "generatedForMovedPatient": {
                        "title": "GeneratedForMovedPatient",
                        "description": "Om sann så är denna enhet endast här pga genererade överflyttade patienter",
                        "type": "boolean"
                    }
                },
                "additionalProperties": false,
                "required": [
                    "dn"
                ]
            }
        },
        "questions": {
            "type": "array",
            "items": {
                "type": "string"
            }
        }
    },
    "additionalProperties": false,
    "required": [
        "measurement",
        "dn",
        "selectionCriterias",
        "organisations"
    ]
}
